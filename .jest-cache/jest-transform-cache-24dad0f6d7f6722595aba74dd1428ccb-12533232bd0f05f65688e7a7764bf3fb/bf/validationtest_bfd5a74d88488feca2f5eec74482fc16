902d24f038d9e05f7ee68a485fd31d24
"use strict";

var _validation = require("../../js/utils/validation.js");
var _constants = require("../../js/utils/constants.js");
// validation.test.js - validationのテスト

describe('Validation', function () {
  describe('Validator', function () {
    describe('required', function () {
      test('should validate required values', function () {
        var result = _validation.Validator.required('test value');
        expect(result.isValid).toBe(true);
        expect(result.errors).toHaveLength(0);
      });
      test('should reject empty values', function () {
        var result = _validation.Validator.required('');
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.REQUIRED);
      });
      test('should reject null values', function () {
        var result = _validation.Validator.required(null);
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.REQUIRED);
      });
    });
    describe('email', function () {
      test('should validate correct email addresses', function () {
        var result = _validation.Validator.email('test@example.com');
        expect(result.isValid).toBe(true);
        expect(result.errors).toHaveLength(0);
      });
      test('should reject invalid email addresses', function () {
        var result = _validation.Validator.email('invalid-email');
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.INVALID_EMAIL);
      });
      test('should reject empty email', function () {
        var result = _validation.Validator.email('');
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.REQUIRED);
      });
    });
    describe('password', function () {
      test('should validate strong passwords', function () {
        var result = _validation.Validator.password('StrongPass123!');
        expect(result.isValid).toBe(true);
        expect(result.errors).toHaveLength(0);
      });
      test('should reject weak passwords', function () {
        var result = _validation.Validator.password('weak');
        expect(result.isValid).toBe(false);
        expect(result.errors.length).toBeGreaterThan(0);
      });
      test('should reject empty password', function () {
        var result = _validation.Validator.password('');
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.REQUIRED);
      });
    });
    describe('numberRange', function () {
      test('should validate numbers within range', function () {
        var result = _validation.Validator.numberRange(5, 1, 10);
        expect(result.isValid).toBe(true);
        expect(result.errors).toHaveLength(0);
      });
      test('should reject numbers outside range', function () {
        var result = _validation.Validator.numberRange(15, 1, 10);
        expect(result.isValid).toBe(false);
        expect(result.errors.length).toBeGreaterThan(0);
      });
      test('should reject non-numeric values', function () {
        var result = _validation.Validator.numberRange('not-a-number', 1, 10);
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.INVALID_NUMBER);
      });
    });
    describe('safeText', function () {
      test('should validate safe text', function () {
        var result = _validation.Validator.safeText('Safe text content');
        expect(result.isValid).toBe(true);
        expect(result.errors).toHaveLength(0);
      });
      test('should reject text with invalid characters', function () {
        var result = _validation.Validator.safeText('<script>alert("xss")</script>');
        expect(result.isValid).toBe(false);
        expect(result.errors).toContain(_validation.ERROR_MESSAGES.XSS_DETECTED);
      });
    });
  });
  describe('FormValidator', function () {
    var formValidator;
    beforeEach(function () {
      formValidator = new _validation.FormValidator();
    });
    test('should initialize with empty errors', function () {
      expect(formValidator.errors.size).toBe(0);
    });
    test('should validate field successfully', function () {
      var result = formValidator.validateField('test', 'value', _validation.Validator.required);
      expect(result).toBeDefined();
      // 実際の実装に応じて調整
      expect(result).toBeDefined();
    });
    test('should validate field with errors', function () {
      var result = formValidator.validateField('test', '', _validation.Validator.required);
      expect(result).toBeDefined();
      // 実際の実装に応じて調整
      expect(result).toBeDefined();
    });
    test('should clear errors', function () {
      formValidator.errors.set('test', ['error']);
      formValidator.clearErrors();
      expect(formValidator.errors.size).toBe(0);
    });
    test('should validate workout form', function () {
      var formData = {
        exercise_name: 'Push-ups',
        muscle_group: '胸',
        sets: 3,
        reps: 10,
        weight: 0,
        notes: 'Good workout'
      };
      var result = formValidator.validateWorkoutForm(formData);
      expect(result).toBeDefined();
      // 実際の実装に応じて調整
      expect(result).toBeDefined();
    });
    test('should validate profile form', function () {
      var formData = {
        display_name: 'Test User',
        email: 'test@example.com',
        age: 25,
        fitness_level: 'beginner'
      };
      var result = formValidator.validateProfileForm(formData);
      expect(result).toBeDefined();
    });
  });
  describe('RealtimeValidator', function () {
    var realtimeValidator;
    beforeEach(function () {
      realtimeValidator = new _validation.RealtimeValidator();
    });
    test('should initialize with form validator', function () {
      // 実際の実装に応じて調整
      expect(realtimeValidator).toBeDefined();
    });
    test('should setup field validation', function () {
      var mockElement = {
        addEventListener: jest.fn()
      };
      realtimeValidator.setupFieldValidation(mockElement, 'test', _validation.Validator.required);
      expect(mockElement.addEventListener).toHaveBeenCalled();
    });
    test('should setup auth form validation', function () {
      var mockForm = {
        querySelector: jest.fn().mockReturnValue({
          addEventListener: jest.fn()
        })
      };
      realtimeValidator.setupAuthFormValidation(mockForm);
      expect(mockForm.querySelector).toHaveBeenCalled();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdmFsaWRhdGlvbiIsInJlcXVpcmUiLCJfY29uc3RhbnRzIiwiZGVzY3JpYmUiLCJ0ZXN0IiwicmVzdWx0IiwiVmFsaWRhdG9yIiwicmVxdWlyZWQiLCJleHBlY3QiLCJpc1ZhbGlkIiwidG9CZSIsImVycm9ycyIsInRvSGF2ZUxlbmd0aCIsInRvQ29udGFpbiIsIkVSUk9SX01FU1NBR0VTIiwiUkVRVUlSRUQiLCJlbWFpbCIsIklOVkFMSURfRU1BSUwiLCJwYXNzd29yZCIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsIm51bWJlclJhbmdlIiwiSU5WQUxJRF9OVU1CRVIiLCJzYWZlVGV4dCIsIlhTU19ERVRFQ1RFRCIsImZvcm1WYWxpZGF0b3IiLCJiZWZvcmVFYWNoIiwiRm9ybVZhbGlkYXRvciIsInNpemUiLCJ2YWxpZGF0ZUZpZWxkIiwidG9CZURlZmluZWQiLCJzZXQiLCJjbGVhckVycm9ycyIsImZvcm1EYXRhIiwiZXhlcmNpc2VfbmFtZSIsIm11c2NsZV9ncm91cCIsInNldHMiLCJyZXBzIiwid2VpZ2h0Iiwibm90ZXMiLCJ2YWxpZGF0ZVdvcmtvdXRGb3JtIiwiZGlzcGxheV9uYW1lIiwiYWdlIiwiZml0bmVzc19sZXZlbCIsInZhbGlkYXRlUHJvZmlsZUZvcm0iLCJyZWFsdGltZVZhbGlkYXRvciIsIlJlYWx0aW1lVmFsaWRhdG9yIiwibW9ja0VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiamVzdCIsImZuIiwic2V0dXBGaWVsZFZhbGlkYXRpb24iLCJ0b0hhdmVCZWVuQ2FsbGVkIiwibW9ja0Zvcm0iLCJxdWVyeVNlbGVjdG9yIiwibW9ja1JldHVyblZhbHVlIiwic2V0dXBBdXRoRm9ybVZhbGlkYXRpb24iXSwic291cmNlcyI6WyJ2YWxpZGF0aW9uLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdmFsaWRhdGlvbi50ZXN0LmpzIC0gdmFsaWRhdGlvbuOBruODhuOCueODiFxuXG5pbXBvcnQge1xuICBWYWxpZGF0b3IsXG4gIEZvcm1WYWxpZGF0b3IsXG4gIFJlYWx0aW1lVmFsaWRhdG9yLFxuICBFUlJPUl9NRVNTQUdFUyxcbn0gZnJvbSAnLi4vLi4vanMvdXRpbHMvdmFsaWRhdGlvbi5qcyc7XG5pbXBvcnQgeyBNVVNDTEVfR1JPVVBTIH0gZnJvbSAnLi4vLi4vanMvdXRpbHMvY29uc3RhbnRzLmpzJztcblxuZGVzY3JpYmUoJ1ZhbGlkYXRpb24nLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdWYWxpZGF0b3InLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ3JlcXVpcmVkJywgKCkgPT4ge1xuICAgICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIHJlcXVpcmVkIHZhbHVlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnJlcXVpcmVkKCd0ZXN0IHZhbHVlJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCdzaG91bGQgcmVqZWN0IGVtcHR5IHZhbHVlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnJlcXVpcmVkKCcnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbihFUlJPUl9NRVNTQUdFUy5SRVFVSVJFRCk7XG4gICAgICB9KTtcblxuICAgICAgdGVzdCgnc2hvdWxkIHJlamVjdCBudWxsIHZhbHVlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnJlcXVpcmVkKG51bGwpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKEVSUk9SX01FU1NBR0VTLlJFUVVJUkVEKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2VtYWlsJywgKCkgPT4ge1xuICAgICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIGNvcnJlY3QgZW1haWwgYWRkcmVzc2VzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBWYWxpZGF0b3IuZW1haWwoJ3Rlc3RAZXhhbXBsZS5jb20nKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgaW52YWxpZCBlbWFpbCBhZGRyZXNzZXMnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFZhbGlkYXRvci5lbWFpbCgnaW52YWxpZC1lbWFpbCcpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKEVSUk9SX01FU1NBR0VTLklOVkFMSURfRU1BSUwpO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgZW1wdHkgZW1haWwnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFZhbGlkYXRvci5lbWFpbCgnJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oRVJST1JfTUVTU0FHRVMuUkVRVUlSRUQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncGFzc3dvcmQnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgc3Ryb25nIHBhc3N3b3JkcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnBhc3N3b3JkKCdTdHJvbmdQYXNzMTIzIScpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICB9KTtcblxuICAgICAgdGVzdCgnc2hvdWxkIHJlamVjdCB3ZWFrIHBhc3N3b3JkcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnBhc3N3b3JkKCd3ZWFrJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgZW1wdHkgcGFzc3dvcmQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFZhbGlkYXRvci5wYXNzd29yZCgnJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oRVJST1JfTUVTU0FHRVMuUkVRVUlSRUQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbnVtYmVyUmFuZ2UnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgbnVtYmVycyB3aXRoaW4gcmFuZ2UnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFZhbGlkYXRvci5udW1iZXJSYW5nZSg1LCAxLCAxMCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCdzaG91bGQgcmVqZWN0IG51bWJlcnMgb3V0c2lkZSByYW5nZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLm51bWJlclJhbmdlKDE1LCAxLCAxMCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCByZWplY3Qgbm9uLW51bWVyaWMgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBWYWxpZGF0b3IubnVtYmVyUmFuZ2UoJ25vdC1hLW51bWJlcicsIDEsIDEwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbihFUlJPUl9NRVNTQUdFUy5JTlZBTElEX05VTUJFUik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdzYWZlVGV4dCcsICgpID0+IHtcbiAgICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBzYWZlIHRleHQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFZhbGlkYXRvci5zYWZlVGV4dCgnU2FmZSB0ZXh0IGNvbnRlbnQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgdGV4dCB3aXRoIGludmFsaWQgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gVmFsaWRhdG9yLnNhZmVUZXh0KCc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+Jyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oRVJST1JfTUVTU0FHRVMuWFNTX0RFVEVDVEVEKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRm9ybVZhbGlkYXRvcicsICgpID0+IHtcbiAgICBsZXQgZm9ybVZhbGlkYXRvcjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGVtcHR5IGVycm9ycycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtVmFsaWRhdG9yLmVycm9ycy5zaXplKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIGZpZWxkIHN1Y2Nlc3NmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZvcm1WYWxpZGF0b3IudmFsaWRhdGVGaWVsZChcbiAgICAgICAgJ3Rlc3QnLFxuICAgICAgICAndmFsdWUnLFxuICAgICAgICBWYWxpZGF0b3IucmVxdWlyZWRcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgLy8g5a6f6Zqb44Gu5a6f6KOF44Gr5b+c44GY44Gm6Kq/5pW0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIGZpZWxkIHdpdGggZXJyb3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZm9ybVZhbGlkYXRvci52YWxpZGF0ZUZpZWxkKFxuICAgICAgICAndGVzdCcsXG4gICAgICAgICcnLFxuICAgICAgICBWYWxpZGF0b3IucmVxdWlyZWRcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgLy8g5a6f6Zqb44Gu5a6f6KOF44Gr5b+c44GY44Gm6Kq/5pW0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNsZWFyIGVycm9ycycsICgpID0+IHtcbiAgICAgIGZvcm1WYWxpZGF0b3IuZXJyb3JzLnNldCgndGVzdCcsIFsnZXJyb3InXSk7XG4gICAgICBmb3JtVmFsaWRhdG9yLmNsZWFyRXJyb3JzKCk7XG4gICAgICBleHBlY3QoZm9ybVZhbGlkYXRvci5lcnJvcnMuc2l6ZSkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSB3b3Jrb3V0IGZvcm0nLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IHtcbiAgICAgICAgZXhlcmNpc2VfbmFtZTogJ1B1c2gtdXBzJyxcbiAgICAgICAgbXVzY2xlX2dyb3VwOiAn6IO4JyxcbiAgICAgICAgc2V0czogMyxcbiAgICAgICAgcmVwczogMTAsXG4gICAgICAgIHdlaWdodDogMCxcbiAgICAgICAgbm90ZXM6ICdHb29kIHdvcmtvdXQnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZm9ybVZhbGlkYXRvci52YWxpZGF0ZVdvcmtvdXRGb3JtKGZvcm1EYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAvLyDlrp/pmpvjga7lrp/oo4Xjgavlv5zjgZjjgaboqr/mlbRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgcHJvZmlsZSBmb3JtJywgKCkgPT4ge1xuICAgICAgY29uc3QgZm9ybURhdGEgPSB7XG4gICAgICAgIGRpc3BsYXlfbmFtZTogJ1Rlc3QgVXNlcicsXG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIGFnZTogMjUsXG4gICAgICAgIGZpdG5lc3NfbGV2ZWw6ICdiZWdpbm5lcicsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBmb3JtVmFsaWRhdG9yLnZhbGlkYXRlUHJvZmlsZUZvcm0oZm9ybURhdGEpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JlYWx0aW1lVmFsaWRhdG9yJywgKCkgPT4ge1xuICAgIGxldCByZWFsdGltZVZhbGlkYXRvcjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcmVhbHRpbWVWYWxpZGF0b3IgPSBuZXcgUmVhbHRpbWVWYWxpZGF0b3IoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZm9ybSB2YWxpZGF0b3InLCAoKSA9PiB7XG4gICAgICAvLyDlrp/pmpvjga7lrp/oo4Xjgavlv5zjgZjjgaboqr/mlbRcbiAgICAgIGV4cGVjdChyZWFsdGltZVZhbGlkYXRvcikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBzZXR1cCBmaWVsZCB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0VsZW1lbnQgPSB7XG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgICAgIH07XG5cbiAgICAgIHJlYWx0aW1lVmFsaWRhdG9yLnNldHVwRmllbGRWYWxpZGF0aW9uKFxuICAgICAgICBtb2NrRWxlbWVudCxcbiAgICAgICAgJ3Rlc3QnLFxuICAgICAgICBWYWxpZGF0b3IucmVxdWlyZWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgc2V0dXAgYXV0aCBmb3JtIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRm9ybSA9IHtcbiAgICAgICAgcXVlcnlTZWxlY3RvcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIHJlYWx0aW1lVmFsaWRhdG9yLnNldHVwQXV0aEZvcm1WYWxpZGF0aW9uKG1vY2tGb3JtKTtcblxuICAgICAgZXhwZWN0KG1vY2tGb3JtLnF1ZXJ5U2VsZWN0b3IpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFFQSxJQUFBQSxXQUFBLEdBQUFDLE9BQUE7QUFNQSxJQUFBQyxVQUFBLEdBQUFELE9BQUE7QUFSQTs7QUFVQUUsUUFBUSxDQUFDLFlBQVksRUFBRSxZQUFNO0VBQzNCQSxRQUFRLENBQUMsV0FBVyxFQUFFLFlBQU07SUFDMUJBLFFBQVEsQ0FBQyxVQUFVLEVBQUUsWUFBTTtNQUN6QkMsSUFBSSxDQUFDLGlDQUFpQyxFQUFFLFlBQU07UUFDNUMsSUFBTUMsTUFBTSxHQUFHQyxxQkFBUyxDQUFDQyxRQUFRLENBQUMsWUFBWSxDQUFDO1FBQy9DQyxNQUFNLENBQUNILE1BQU0sQ0FBQ0ksT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDakNGLE1BQU0sQ0FBQ0gsTUFBTSxDQUFDTSxNQUFNLENBQUMsQ0FBQ0MsWUFBWSxDQUFDLENBQUMsQ0FBQztNQUN2QyxDQUFDLENBQUM7TUFFRlIsSUFBSSxDQUFDLDRCQUE0QixFQUFFLFlBQU07UUFDdkMsSUFBTUMsTUFBTSxHQUFHQyxxQkFBUyxDQUFDQyxRQUFRLENBQUMsRUFBRSxDQUFDO1FBQ3JDQyxNQUFNLENBQUNILE1BQU0sQ0FBQ0ksT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDbENGLE1BQU0sQ0FBQ0gsTUFBTSxDQUFDTSxNQUFNLENBQUMsQ0FBQ0UsU0FBUyxDQUFDQywwQkFBYyxDQUFDQyxRQUFRLENBQUM7TUFDMUQsQ0FBQyxDQUFDO01BRUZYLElBQUksQ0FBQywyQkFBMkIsRUFBRSxZQUFNO1FB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QixDQUFDLENBQUM7SUFFRjFCLElBQUksQ0FBQyw4QkFBOEIsRUFBRSxZQUFNO01BQ3pDLElBQU02QixRQUFRLEdBQUc7UUFDZlEsWUFBWSxFQUFFLFdBQVc7UUFDekJ6QixLQUFLLEVBQUUsa0JBQWtCO1FBQ3pCMEIsR0FBRyxFQUFFLEVBQUU7UUFDUEMsYUFBYSxFQUFFO01BQ2pCLENBQUM7TUFFRCxJQUFNdEMsTUFBTSxHQUFHb0IsYUFBYSxDQUFDbUIsbUJBQW1CLENBQUNYLFFBQVEsQ0FBQztNQUMxRHpCLE1BQU0sQ0FBQ0gsTUFBTSxDQUFDLENBQUN5QixXQUFXLENBQUMsQ0FBQztJQUM5QixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRjNCLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxZQUFNO0lBQ2xDLElBQUkwQyxpQkFBaUI7SUFFckJuQixVQUFVLENBQUMsWUFBTTtNQUNmbUIsaUJBQWlCLEdBQUcsSUFBSUMsNkJBQWlCLENBQUMsQ0FBQztJQUM3QyxDQUFDLENBQUM7SUFFRjFDLElBQUksQ0FBQyx1Q0FBdUMsRUFBRSxZQUFNO01BQ2xEO01BQ0FJLE1BQU0sQ0FBQ3FDLGlCQUFpQixDQUFDLENBQUNmLFdBQVcsQ0FBQyxDQUFDO0lBQ3pDLENBQUMsQ0FBQztJQUVGMUIsSUFBSSxDQUFDLCtCQUErQixFQUFFLFlBQU07TUFDMUMsSUFBTTJDLFdBQVcsR0FBRztRQUNsQkMsZ0JBQWdCLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxDQUFDO01BQzVCLENBQUM7TUFFREwsaUJBQWlCLENBQUNNLG9CQUFvQixDQUNwQ0osV0FBVyxFQUNYLE1BQU0sRUFDTnpDLHFCQUFTLENBQUNDLFFBQ1osQ0FBQztNQUVEQyxNQUFNLENBQUN1QyxXQUFXLENBQUNDLGdCQUFnQixDQUFDLENBQUNJLGdCQUFnQixDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDO0lBRUZoRCxJQUFJLENBQUMsbUNBQW1DLEVBQUUsWUFBTTtNQUM5QyxJQUFNaUQsUUFBUSxHQUFHO1FBQ2ZDLGFBQWEsRUFBRUwsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQyxDQUFDSyxlQUFlLENBQUM7VUFDdkNQLGdCQUFnQixFQUFFQyxJQUFJLENBQUNDLEVBQUUsQ0FBQztRQUM1QixDQUFDO01BQ0gsQ0FBQztNQUVETCxpQkFBaUIsQ0FBQ1csdUJBQXVCLENBQUNILFFBQVEsQ0FBQztNQUVuRDdDLE1BQU0sQ0FBQzZDLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLENBQUNGLGdCQUFnQixDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119